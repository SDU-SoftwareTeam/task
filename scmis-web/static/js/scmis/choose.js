var apiKeys1=['course_id','course_name','teacher_name','period','classroom','end_time','grade'];var apiKeys2=['id','course_name','teacher_name','period','classroom','end_time','description','capacity','max_capacity'];var dataTablesObject1=null;var dataTablesObject2=null;$(document)['ready'](function(){dataTablesObject1=initTable('table1');dataTablesObject2=initTable('table2');$('.dataTables_filter')['hide']();$('.dt-buttons')['hide']();$('#btn-Query')['on']('click',ChooseQuery);own();ChooseQuery();});function own(){AJAX({'url':'/api/take/querySelf','type':'POST','beforeSend':function(){NProgress['start']();},'complete':function(){NProgress['done']();},'success':function(_0x3a282b){if(_0x3a282b['errcode']!=='0'){alert(_0x3a282b['errmsg']);if(_0x3a282b['errcode']==='4101'){window['location']['href']='/';}return;}if(typeof dataTablesObject1!='undefined'&&dataTablesObject1!=null){dataTablesObject1['destroy']();}$('#table1>tbody\x20td')['remove']();var _0x2df0bd=$('#table1>tbody')[0x0];_0x3a282b['data']['forEach'](function(_0x42389f){var _0x1eb0b7=_0x2df0bd['insertRow']();for(var _0x3239ca=0x0;_0x3239ca<apiKeys1['length'];_0x3239ca++){var _0xd4967c=_0x1eb0b7['insertCell']();_0xd4967c['style']='text-align:\x20center;';_0xd4967c['innerHTML']=_0x42389f[apiKeys1[_0x3239ca]];_0xd4967c['setAttribute']('value',_0xd4967c['innerHTML']);if(apiKeys1[_0x3239ca]==='grade'&&_0xd4967c['innerHTML']==''){_0xd4967c['innerHTML']='暂无';}else if(apiKeys1[_0x3239ca]==='teacher_name'){_0xd4967c['innerHTML']=_0x42389f['teacher_name'];}}var _0xd4967c=_0x1eb0b7['insertCell']();_0xd4967c['style']='text-align:\x20center;';_0xd4967c['innerHTML']='<a\x20style=\x22cursor:pointer\x22\x20onclick=\x22deleteClicked(this)\x22>退选</a>\x20';});dataTablesObject1=initTable('table1');$('.dataTables_filter')['hide']();$('.dt-buttons')['hide']();}});}function deleteClicked(_0x3b077f){var _0x216596=JSON['stringify']({'course_id':_0x3b077f['parentElement']['parentElement']['cells'][0x0]['innerHTML']});if(confirm('确定删除课程信息?')){AJAX({'url':'/api/take/delete','type':'POST','data':_0x216596,'contentType':'application/json','beforeSend':function(){NProgress['start']();},'complete':function(){NProgress['done']();},'success':function(_0x1ad1fe){console['log'](_0x1ad1fe);if(_0x1ad1fe['errcode']==='0'){dataTablesObject1['row'](_0x3b077f['parentElement']['parentElement'])['remove']()['draw']();alert(_0x1ad1fe['errmsg']);}else{alert(_0x1ad1fe['errmsg']);}}});}}function ChooseQuery(){var _0x2462f3=JSON['stringify']({'class_name':$('#CourseName')['val'](),'id':$('#CourseId')['val'](),'teacher_name':$('#TeacherName')['val'](),'teacher_id':null});AJAX({'url':'/api/course/query','type':'POST','data':_0x2462f3,'contentType':'application/json','beforeSend':function(){NProgress['start']();$('#btn-Query')['text']('查询中...')['attr']('disabled',!![]);},'complete':function(){NProgress['done']();$('#btn-Query')['text']('查询课程设置信息')['attr']('disabled',![]);},'success':function(_0x44b3a0){if(_0x44b3a0['errcode']!=='0'){alert(_0x44b3a0['errmsg']);if(_0x44b3a0['errcode']==='4101'){window['location']['href']='/';}return;}if(typeof dataTablesObject2!=='undefined'&&dataTablesObject1!==null){dataTablesObject2['destroy']();}$('#table2>tbody\x20tr')['remove']();var _0x14cc81=$('#table2>tbody')[0x0];_0x44b3a0['data']['forEach'](function(_0x21061e){var _0x5e613e=_0x14cc81['insertRow']();for(var _0x52666c=0x0;_0x52666c<apiKeys2['length'];_0x52666c++){var _0x37c34e=_0x5e613e['insertCell']();_0x37c34e['style']='text-align:\x20center;';_0x37c34e['innerHTML']=_0x21061e[apiKeys2[_0x52666c]];_0x37c34e['setAttribute']('value',_0x37c34e['innerHTML']);if(apiKeys2[_0x52666c]==='teacher_name'){_0x37c34e['innerHTML']=_0x21061e['teacher_name'];}}var _0x37c34e=_0x5e613e['insertCell']();_0x37c34e['style']='text-align:\x20center;';_0x37c34e['innerHTML']='<a\x20style=\x22cursor:pointer\x22\x20onclick=\x22addClicked(this)\x22>选课</a>\x20';});dataTablesObject2=initTable('table2');$('.dataTables_filter')['hide']();$('.dt-buttons')['hide']();}});}function addClicked(_0x4aca94){var _0x5a8235=JSON['stringify']({'course_id':_0x4aca94['parentElement']['parentElement']['cells'][0x0]['innerHTML']});console['log'](_0x5a8235);if(confirm('确定选课?')){AJAX({'url':'/api/take/add','type':'POST','data':_0x5a8235,'contentType':'application/json','beforeSend':function(){NProgress['start']();},'complete':function(){NProgress['done']();},'success':function(_0x440f81){if(_0x440f81['errcode']==='0'){alert(_0x440f81['errmsg']);own();}else{alert(_0x440f81['errmsg']);}}});}}